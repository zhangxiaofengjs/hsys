<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hsys.mappers.ProjectMapper">
	<resultMap id="projectResultMap" type="projectModel" >  
        <id column="p_id" property="id"/>  
        <result column="p_no" property="no"/>
        <result column="p_name" property="name"/>
    </resultMap>
	<resultMap id="userResultMap" type="userModel" >  
        <id column="u_id" property="id"/>  
        <result column="u_no" property="no"/>
        <result column="u_name" property="name"/>
    </resultMap>

	<select id="queryList" resultMap="projectResultMap">
		select p.c_id as p_id,
			   p.c_no as p_no,
			   p.c_name as p_name
		from project_tbl as p
		<if test="cond.leaderId != null">
			left join project_leader_tbl as pl on pl.c_project_id=p.c_id
		</if>
		<where>
			<if test="cond.no != null">
				and p.c_no = #{no}
			</if>
			<if test="cond.leaderId != null">
				and pl.c_leader_id = #{cond.leaderId}
			</if>
		</where>
		order by p.c_no
	</select>
	
	<select id="queryLeaderList" resultMap="userResultMap">
		select u.c_id as u_id,
			   u.c_no as u_no,
			   u.c_name as u_name
		from project_leader_tbl as pl
		left join user_tbl as u on u.c_id=pl.c_leader_id
		<where>
			<if test="cond.id != null">
				and pl.c_id = #{id}
			</if>
			<if test="cond.leaderId != null">
				and pl.c_leader_id = #{cond.leaderId}
			</if>
		</where>
		order by u.c_no
	</select>
</mapper>